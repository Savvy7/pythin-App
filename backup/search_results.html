{% extends "base.html" %}

{% block title %}Search Results{% endblock %}

{% block content %}
    <div class="search-header">
        <h1>Search Results</h1>
        
        <form action="{{ url_for('search') }}" method="get" class="search-form">
            <div class="search-input-container">
                <i class="fas fa-search"></i>
                <input type="text" name="query" placeholder="Search for games..." value="{{ request.args.get('query', '') }}" required>
                <button type="submit" class="search-btn">Search</button>
            </div>
        </form>
    </div>

    {% if games %}
        <div class="results-count">
            Found {{ games|length }} game{{ 's' if games|length != 1 else '' }}
        </div>
        
        <div class="game-grid">
            {% for game in games %}
                <div class="game-card">
                    <div class="game-cover-container">
                        {% if game.cover %}
                            <img src="https:{{ game.cover }}" alt="{{ game.name }} cover" class="game-cover">
                        {% else %}
                            <img src="https://placehold.co/400x600/252a31/555?text=No+Cover" alt="No cover available" class="game-cover">
                        {% endif %}
                    </div>
                    <div class="game-card-body">
                        <h3 class="game-title" title="{{ game.name }}">{{ game.name }}</h3>
                        <div class="game-meta">
                            <span class="game-release">
                                {% if game.release_date %}
                                    {{ game.release_date }}
                                {% else %}
                                    Unknown
                                {% endif %}
                            </span>
                            {% if game.platforms %}
                                <span class="game-platform">
                                    {{ game.platforms[0] }}
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    {% if logged_in %}
                    <a href="{{ url_for('add_game', igdb_id=game.id) }}" class="add-game-btn" title="Add to library">
                        <i class="fas fa-plus"></i>
                    </a>
                    {% else %}
                    <a href="{{ url_for('login') }}" class="add-game-btn login-required" title="Login to add">
                        <i class="fas fa-lock"></i>
                    </a>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-results">
            <div class="empty-results-message">
                <i class="fas fa-search fa-4x"></i>
                {% if request.args.get('query') %}
                    <h2>No games found</h2>
                    <p>We couldn't find any games matching your search. Try different keywords or check your spelling.</p>
                {% else %}
                    <h2>Search for games</h2>
                    <p>Enter a game title, developer, or genre in the search box above to find games.</p>
                {% endif %}
            </div>
        </div>
    {% endif %}

    <style>
        .search-header {
            margin-bottom: 2rem;
        }

        .search-form {
            max-width: 600px;
            margin-top: 1rem;
        }

        .search-input-container {
            position: relative;
            display: flex;
        }

        .search-input-container input {
            flex: 1;
            padding: 0.8rem 1rem 0.8rem 2.5rem;
            background-color: var(--sidebar-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px 0 0 4px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .search-input-container i {
            position: absolute;
            left: 0.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .search-btn {
            background-color: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            padding: 0 1.2rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-btn:hover {
            background-color: var(--accent-blue-hover);
        }

        .results-count {
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .add-game-btn {
            position: absolute;
            bottom: 0.8rem;
            right: 0.8rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: var(--accent-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, background-color 0.2s;
            z-index: 5;
        }

        .add-game-btn:hover {
            transform: scale(1.1);
            background-color: var(--accent-blue-hover);
        }

        .login-required {
            background-color: var(--text-secondary);
        }

        .empty-results {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 60vh;
        }

        .empty-results-message {
            text-align: center;
            color: var(--text-secondary);
            max-width: 400px;
        }

        .empty-results-message i {
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }

        .empty-results-message h2 {
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .empty-results-message p {
            line-height: 1.5;
        }
    </style>
{% endblock %}